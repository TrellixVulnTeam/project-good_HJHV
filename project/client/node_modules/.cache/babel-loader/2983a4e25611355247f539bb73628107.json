{"ast":null,"code":"var _jsxFileName = \"D:\\\\project-good\\\\project\\\\client\\\\src\\\\components\\\\new auction\\\\PublicationApproval.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { connect } from \"react-redux\";\nimport './NewAuction.scss';\nimport { setNewAuction } from '../../store/actions/newAuction';\nimport Checkbox from '@mui/material/Checkbox';\nimport FormControlLabel from '@mui/material/FormControlLabel';\nimport { setUserByStorage, setCurrentAuctionByStorage, setNewAuctionByStorage } from '../../store/actions/user';\nimport { savePublicationApprovalInDB } from '../../utils/newAuctionUtils';\nimport Alert from '@mui/material/Alert';\nimport { styled } from '@mui/material/styles';\nimport Box from '@mui/material/Box';\nimport CircularProgress, { circularProgressClasses, CircularProgressProps } from '@mui/material/CircularProgress';\nimport LinearProgress, { linearProgressClasses } from '@mui/material/LinearProgress';\nimport { Stack } from '@mui/material'; // Inspired by the former Facebook spinners.\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction FacebookCircularProgress(props) {\n  return /*#__PURE__*/_jsxDEV(Box, {\n    sx: {\n      position: 'relative'\n    },\n    children: [/*#__PURE__*/_jsxDEV(CircularProgress, {\n      variant: \"determinate\",\n      sx: {\n        color: theme => theme.palette.grey[theme.palette.mode === 'light' ? 200 : 800]\n      },\n      size: 40,\n      thickness: 4,\n      ...props,\n      value: 100\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 25,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(CircularProgress, {\n      variant: \"indeterminate\",\n      disableShrink: true,\n      sx: {\n        color: theme => theme.palette.mode === 'light' ? '#1a90ff' : '#308fe8',\n        animationDuration: '550ms',\n        position: 'absolute',\n        left: 0,\n        [`& .${circularProgressClasses.circle}`]: {\n          strokeLinecap: 'round'\n        }\n      },\n      size: 40,\n      thickness: 4,\n      ...props\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 36,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 24,\n    columnNumber: 9\n  }, this);\n}\n\n_c = FacebookCircularProgress;\n\nconst PublicationApproval = props => {\n  _s();\n\n  useEffect(() => {\n    let id = localStorage.getItem(\"user\");\n\n    if (id && props.currentUser == null) {\n      // let a_id = localStorage.getItem(\"currentAuction\");\n      let n_a_id = localStorage.getItem(\"newAuction\"); // if (a_id) props.setCurrentAuctionByStorage(a_id);\n\n      if (n_a_id) props.setNewAuctionByStorage(n_a_id);\n      props.setUserByStorage(id);\n    }\n  }, []);\n  useEffect(() => {\n    return () => {\n      alert(publicationApproval);\n      savePublicationApprovalInDB(props.auctionId, publicationApproval).then(succ => {\n        if (succ.status != 400) props.setNewAuction(succ.data);\n      });\n    };\n  }, []);\n  const [publicationApproval, setPublicationApproval] = React.useState(false);\n  const [succses, setSuccses] = React.useState(false);\n  const [loading, setLoading] = React.useState(false);\n  const [isShowAlert, setIsShowAlert] = React.useState(false);\n  const [myAlert, setMyAlert] = React.useState(null);\n\n  const check = () => {\n    setLoading(true);\n    setIsShowAlert(false);\n    let isLotValid = new Date(props.lot).valueOf() > new Date(props.end).valueOf();\n    let isEndValid = new Date(props.end).valueOf() > new Date(props.start).valueOf();\n    let isLotValid2 = new Date(props.lot).valueOf() > new Date().valueOf();\n    let isNoNull = props.end != null && props.start != null && props.lot != null;\n    let isList = props.list != null && props.list.length > 0;\n    let isName = props.name != \"\" || props.oName != \"\";\n\n    if (isLotValid && isEndValid && isLotValid2 && isNoNull && isList && isName) {\n      setTimeout(() => {\n        setLoading(false);\n        setSuccses(true);\n      }, 1000);\n    } else {\n      let arr = [];\n      if (!isLotValid) arr.push(\"The lottery date should be after the registration end date!\");\n      if (!isEndValid) arr.push(\"Registration end date should be after registration start date!\");\n      if (!isLotValid) arr.push(\"The lottery date should be a date in the future.\");\n      if (!isNoNull) arr.push(\"Please fill in all the dates that constitute information on your Chinese auction!\");\n      if (!isList) arr.push(\"Products have been set up for your Chinese auction!\");\n      if (!isName) arr.push(\"An organization name and Chinese auction name must be filled in at least one of them!\");\n      setMyAlert(arr);\n      setTimeout(() => {\n        setLoading(false);\n        setIsShowAlert(true);\n        setSuccses(false); //מיותר\n      }, 1000);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Have you already approved the publication of your Chinese auction?\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\" After your approval, you will not be able to regret and / or update its details.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 97\n      }, this), \"If you do not approve the publication now, you can continue to build your Chinese auction whenever you want.\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Button, {\n      onClick: check,\n      style: {\n        backgroundColor: \"#e0e0e0\",\n        color: \"#262b96\"\n      },\n      variant: \"contained\",\n      color: \"primary\",\n      component: \"span\",\n      children: \"Check\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 13\n    }, this), loading && /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        flexGrow: 1\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(FacebookCircularProgress, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 25\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Stack, {\n      sx: {\n        width: '70%'\n      },\n      spacing: 2,\n      children: isShowAlert && myAlert && myAlert.length > 0 && myAlert.map(item => {\n        return /*#__PURE__*/_jsxDEV(Alert, {\n          severity: \"warning\",\n          children: item\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 28\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(FormControlLabel, {\n      control: /*#__PURE__*/_jsxDEV(Checkbox, {\n        checked: publicationApproval,\n        disabled: !succses,\n        onChange: e => setPublicationApproval(e.target.checked)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 26\n      }, this),\n      label: \"I confirm that my auction is displayed on the site\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n};\n\n_s(PublicationApproval, \"z91R0/BXEU7qH9RUCWtHv1bS/bo=\");\n\n_c2 = PublicationApproval;\n\nconst mapStateToProps = state => {\n  return {\n    auctionId: state.auction.newAuction._id,\n    currentUser: state.user.currentUser,\n    auction: state.auction.newAuction,\n    end: state.auction.newAuction.registrationEndDate,\n    start: state.auction.newAuction.registrationStartDate,\n    lot: state.auction.newAuction.lotteriesDate,\n    list: state.auction.newAuction.productList,\n    name: state.auction.newAuction.name,\n    oName: state.auction.newAuction.organizationName\n  };\n};\n\nexport default connect(mapStateToProps, {\n  setNewAuction,\n  setNewAuctionByStorage,\n  setCurrentAuctionByStorage,\n  setUserByStorage\n})(PublicationApproval);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"FacebookCircularProgress\");\n$RefreshReg$(_c2, \"PublicationApproval\");","map":{"version":3,"sources":["D:/project-good/project/client/src/components/new auction/PublicationApproval.js"],"names":["React","useEffect","useState","connect","setNewAuction","Checkbox","FormControlLabel","setUserByStorage","setCurrentAuctionByStorage","setNewAuctionByStorage","savePublicationApprovalInDB","Alert","styled","Box","CircularProgress","circularProgressClasses","CircularProgressProps","LinearProgress","linearProgressClasses","Stack","FacebookCircularProgress","props","position","color","theme","palette","grey","mode","animationDuration","left","circle","strokeLinecap","PublicationApproval","id","localStorage","getItem","currentUser","n_a_id","alert","publicationApproval","auctionId","then","succ","status","data","setPublicationApproval","succses","setSuccses","loading","setLoading","isShowAlert","setIsShowAlert","myAlert","setMyAlert","check","isLotValid","Date","lot","valueOf","end","isEndValid","start","isLotValid2","isNoNull","isList","list","length","isName","name","oName","setTimeout","arr","push","backgroundColor","flexGrow","width","map","item","e","target","checked","mapStateToProps","state","auction","newAuction","_id","user","registrationEndDate","registrationStartDate","lotteriesDate","productList","organizationName"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { connect } from \"react-redux\";\r\nimport './NewAuction.scss'\r\nimport { setNewAuction } from '../../store/actions/newAuction';\r\nimport Checkbox from '@mui/material/Checkbox';\r\nimport FormControlLabel from '@mui/material/FormControlLabel';\r\nimport { setUserByStorage, setCurrentAuctionByStorage, setNewAuctionByStorage } from '../../store/actions/user';\r\nimport { savePublicationApprovalInDB } from '../../utils/newAuctionUtils';\r\n\r\nimport Alert from '@mui/material/Alert';\r\n\r\nimport { styled } from '@mui/material/styles';\r\nimport Box from '@mui/material/Box';\r\nimport CircularProgress, {\r\n    circularProgressClasses,\r\n    CircularProgressProps,\r\n} from '@mui/material/CircularProgress';\r\nimport LinearProgress, { linearProgressClasses } from '@mui/material/LinearProgress';\r\nimport { Stack } from '@mui/material';\r\n\r\n// Inspired by the former Facebook spinners.\r\nfunction FacebookCircularProgress(props) {\r\n    return (\r\n        <Box sx={{ position: 'relative' }}>\r\n            <CircularProgress\r\n                variant=\"determinate\"\r\n                sx={{\r\n                    color: (theme) =>\r\n                        theme.palette.grey[theme.palette.mode === 'light' ? 200 : 800],\r\n                }}\r\n                size={40}\r\n                thickness={4}\r\n                {...props}\r\n                value={100}\r\n            />\r\n            <CircularProgress\r\n                variant=\"indeterminate\"\r\n                disableShrink\r\n                sx={{\r\n                    color: (theme) => (theme.palette.mode === 'light' ? '#1a90ff' : '#308fe8'),\r\n                    animationDuration: '550ms',\r\n                    position: 'absolute',\r\n                    left: 0,\r\n                    [`& .${circularProgressClasses.circle}`]: {\r\n                        strokeLinecap: 'round',\r\n                    },\r\n                }}\r\n                size={40}\r\n                thickness={4}\r\n                {...props}\r\n            />\r\n        </Box>\r\n    );\r\n}\r\n\r\n\r\nconst PublicationApproval = (props) => {\r\n\r\n    useEffect(() => {\r\n        let id = localStorage.getItem(\"user\");\r\n\r\n        if (id && props.currentUser == null) {\r\n\r\n            // let a_id = localStorage.getItem(\"currentAuction\");\r\n            let n_a_id = localStorage.getItem(\"newAuction\");\r\n            // if (a_id) props.setCurrentAuctionByStorage(a_id);\r\n            if (n_a_id) props.setNewAuctionByStorage(n_a_id);\r\n            props.setUserByStorage(id);\r\n        }\r\n\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        return () => {\r\n            alert(publicationApproval)\r\n            savePublicationApprovalInDB(props.auctionId, publicationApproval).then(succ => {\r\n                if (succ.status != 400) props.setNewAuction(succ.data);\r\n            })\r\n        }\r\n    }, [])\r\n\r\n    const [publicationApproval, setPublicationApproval] = React.useState(false);\r\n    const [succses, setSuccses] = React.useState(false);\r\n    const [loading, setLoading] = React.useState(false);\r\n    const [isShowAlert, setIsShowAlert] = React.useState(false);\r\n    const [myAlert, setMyAlert] = React.useState(null);\r\n\r\n    const check = () => {\r\n\r\n        setLoading(true)\r\n        setIsShowAlert(false)\r\n        let isLotValid = new Date(props.lot).valueOf() > new Date(props.end).valueOf();\r\n        let isEndValid = new Date(props.end).valueOf() > new Date(props.start).valueOf();\r\n        let isLotValid2 = new Date(props.lot).valueOf() > new Date().valueOf();\r\n        let isNoNull = props.end != null && props.start != null && props.lot != null;\r\n        let isList = props.list != null && props.list.length > 0;\r\n        let isName = props.name != \"\" || props.oName != \"\";\r\n\r\n        if (isLotValid && isEndValid && isLotValid2 && isNoNull && isList && isName) {\r\n            setTimeout(() => {\r\n                setLoading(false)\r\n                setSuccses(true)\r\n            }, 1000);\r\n\r\n        }\r\n        else {\r\n            let arr = [];\r\n            if (!isLotValid)\r\n                arr.push(\"The lottery date should be after the registration end date!\")\r\n            if (!isEndValid)\r\n                arr.push(\"Registration end date should be after registration start date!\")\r\n            if (!isLotValid)\r\n                arr.push(\"The lottery date should be a date in the future.\")\r\n            if (!isNoNull)\r\n                arr.push(\"Please fill in all the dates that constitute information on your Chinese auction!\")\r\n            if (!isList)\r\n                arr.push(\"Products have been set up for your Chinese auction!\")\r\n            if (!isName)\r\n                arr.push(\"An organization name and Chinese auction name must be filled in at least one of them!\")\r\n\r\n            setMyAlert(arr);\r\n\r\n            setTimeout(() => {\r\n                setLoading(false);\r\n                setIsShowAlert(true)\r\n                setSuccses(false);//מיותר\r\n            }, 1000);\r\n\r\n        }\r\n\r\n\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <br />\r\n            <h1>Have you already approved the publication of your Chinese auction?</h1>\r\n            <p> After your approval, you will not be able to regret and / or update its details.<br />\r\n                If you do not approve the publication now, you can continue to build your Chinese auction whenever you want.</p>\r\n            <Button onClick={check} style={{ backgroundColor: \"#e0e0e0\", color: \"#262b96\" }} variant=\"contained\" color=\"primary\" component=\"span\">Check</Button>\r\n\r\n            {loading && <Box sx={{ flexGrow: 1 }}>\r\n                <br />\r\n                <FacebookCircularProgress />\r\n            </Box>}\r\n            <br />\r\n\r\n            <Stack sx={{ width: '70%' }} spacing={2}>\r\n                {isShowAlert && myAlert && myAlert.length > 0 && myAlert.map(item => {\r\n                    return <Alert severity=\"warning\">{item}</Alert>\r\n                })}\r\n            </Stack>\r\n\r\n            <FormControlLabel\r\n                control={<Checkbox checked={publicationApproval}\r\n                    disabled={!succses}\r\n                    onChange={(e) => setPublicationApproval(e.target.checked)} />}\r\n                label=\"I confirm that my auction is displayed on the site\" />\r\n            <br />\r\n\r\n        </>\r\n\r\n    );\r\n}\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        auctionId: state.auction.newAuction._id,\r\n        currentUser: state.user.currentUser,\r\n        auction: state.auction.newAuction,\r\n        end: state.auction.newAuction.registrationEndDate,\r\n        start: state.auction.newAuction.registrationStartDate,\r\n        lot: state.auction.newAuction.lotteriesDate,\r\n        list: state.auction.newAuction.productList,\r\n        name: state.auction.newAuction.name,\r\n        oName: state.auction.newAuction.organizationName\r\n    }\r\n}\r\nexport default connect(mapStateToProps, { setNewAuction, setNewAuctionByStorage, setCurrentAuctionByStorage, setUserByStorage })(PublicationApproval);\r\n\r\n"]},"metadata":{},"sourceType":"module"}