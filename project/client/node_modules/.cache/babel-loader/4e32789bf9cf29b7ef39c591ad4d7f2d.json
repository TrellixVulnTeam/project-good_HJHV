{"ast":null,"code":"import { useEffect } from \"react\";\nimport { logger } from \"@rpldy/shared\";\nimport { useUploadyContext } from \"@rpldy/shared-ui\"; //https://html.spec.whatwg.org/multipage/form-control-infrastructure.html#form-submission-algorithm\n\nconst getUrl = form => {\n  const loc = window.location;\n  let url = form.getAttribute(\"action\") || \"\";\n  url = url.replace(/\\s/g, \"\");\n  let path; // eslint-disable-next-line default-case\n\n  switch (true) {\n    //if empty, use same url as page\n    case url === \"\":\n      url = loc.href;\n      break;\n    //starts with \"/\", make it absolute\n\n    case url.startsWith(\"/\"):\n      url = `${loc.protocol}//${loc.host}${url}`;\n      break;\n    //not an http(s) and doesnt start with \"/\", make it relative\n\n    case !/:\\/\\//.test(url):\n      path = loc.pathname.split(\"/\").slice(0, -1).concat(\"\").join(\"/\");\n      url = `${loc.protocol}//${loc.host}${path}${url}`;\n      break;\n  }\n\n  return url;\n};\n\nconst getDestinationFromInput = input => {\n  const form = input.closest(\"form\");\n  let destination = {\n    filesParamName: input.getAttribute(\"name\"),\n    method: undefined,\n    url: undefined\n  };\n\n  if (form) {\n    const method = form.getAttribute(\"method\"),\n          url = getUrl(form);\n    destination.method = method ? method.toUpperCase() : undefined;\n    destination.url = url;\n    logger.debugLog(`Uploady.useFileInput: using custom input's parent form url ${destination.url} and method ${destination.method || \"\"}`);\n  }\n\n  return destination;\n};\n\nconst useFileInput = fileInputRef => {\n  const context = useUploadyContext();\n\n  if (fileInputRef) {\n    context.setExternalFileInput(fileInputRef);\n  }\n\n  useEffect(() => {\n    //uses Element.prototype.closest so no IE11 support - use polyfill\n    if (fileInputRef !== null && fileInputRef !== void 0 && fileInputRef.current && \"closest\" in fileInputRef.current) {\n      const input = fileInputRef.current;\n      const uploaderOptions = context.getOptions(); //if no destination was passed, try and get from input's parent form\n\n      if (!uploaderOptions.destination || !uploaderOptions.destination.url) {\n        const domDestination = getDestinationFromInput(input);\n        context.setOptions({\n          destination: domDestination\n        });\n      }\n    }\n  }, [fileInputRef, context]);\n  return !!fileInputRef ? fileInputRef : context.getInternalFileInput();\n};\n\nexport default useFileInput;","map":{"version":3,"sources":["C:/Users/USER/Documents/GitHub/project-good/project/client/node_modules/@rpldy/uploady/lib/esm/useFileInput.js"],"names":["useEffect","logger","useUploadyContext","getUrl","form","loc","window","location","url","getAttribute","replace","path","href","startsWith","protocol","host","test","pathname","split","slice","concat","join","getDestinationFromInput","input","closest","destination","filesParamName","method","undefined","toUpperCase","debugLog","useFileInput","fileInputRef","context","setExternalFileInput","current","uploaderOptions","getOptions","domDestination","setOptions","getInternalFileInput"],"mappings":"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","sourcesContent":["import { useEffect } from \"react\";\nimport { logger } from \"@rpldy/shared\";\nimport { useUploadyContext } from \"@rpldy/shared-ui\";\n\n//https://html.spec.whatwg.org/multipage/form-control-infrastructure.html#form-submission-algorithm\nconst getUrl = form => {\n  const loc = window.location;\n  let url = form.getAttribute(\"action\") || \"\";\n  url = url.replace(/\\s/g, \"\");\n  let path; // eslint-disable-next-line default-case\n\n  switch (true) {\n    //if empty, use same url as page\n    case url === \"\":\n      url = loc.href;\n      break;\n    //starts with \"/\", make it absolute\n\n    case url.startsWith(\"/\"):\n      url = `${loc.protocol}//${loc.host}${url}`;\n      break;\n    //not an http(s) and doesnt start with \"/\", make it relative\n\n    case !/:\\/\\//.test(url):\n      path = loc.pathname.split(\"/\").slice(0, -1).concat(\"\").join(\"/\");\n      url = `${loc.protocol}//${loc.host}${path}${url}`;\n      break;\n  }\n\n  return url;\n};\n\nconst getDestinationFromInput = input => {\n  const form = input.closest(\"form\");\n  let destination = {\n    filesParamName: input.getAttribute(\"name\"),\n    method: undefined,\n    url: undefined\n  };\n\n  if (form) {\n    const method = form.getAttribute(\"method\"),\n          url = getUrl(form);\n    destination.method = method ? method.toUpperCase() : undefined;\n    destination.url = url;\n    logger.debugLog(`Uploady.useFileInput: using custom input's parent form url ${destination.url} and method ${destination.method || \"\"}`);\n  }\n\n  return destination;\n};\n\nconst useFileInput = fileInputRef => {\n  const context = useUploadyContext();\n\n  if (fileInputRef) {\n    context.setExternalFileInput(fileInputRef);\n  }\n\n  useEffect(() => {\n    //uses Element.prototype.closest so no IE11 support - use polyfill\n    if (fileInputRef !== null && fileInputRef !== void 0 && fileInputRef.current && \"closest\" in fileInputRef.current) {\n      const input = fileInputRef.current;\n      const uploaderOptions = context.getOptions(); //if no destination was passed, try and get from input's parent form\n\n      if (!uploaderOptions.destination || !uploaderOptions.destination.url) {\n        const domDestination = getDestinationFromInput(input);\n        context.setOptions({\n          destination: domDestination\n        });\n      }\n    }\n  }, [fileInputRef, context]);\n  return !!fileInputRef ? fileInputRef : context.getInternalFileInput();\n};\n\nexport default useFileInput;"]},"metadata":{},"sourceType":"module"}